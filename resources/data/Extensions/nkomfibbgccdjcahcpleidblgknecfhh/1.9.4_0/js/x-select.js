const XSelect=class{constructor(a,b,c,d=()=>{}){this.$box=$(a),this.items=b,this.storage=null,this.value=c,this.cb=d,this.searchQuery="",this.initStorage(),this.initHandlers(),this.initListeners(),this.renderView(),this.initUI()}get selectedItem(){return this.items.find(a=>a.value===this.value)||(this.value=this.items[0].value,this.cb(this.value)),this.items.find(a=>a.value===this.value)}initStorage(){chrome.storage.local.get(this.storage,a=>{this.storage=a,this.renderList(),this.renderFavorites()})}initUI(){$("a[href=\"#favorite\"]").click(()=>{this.renderFavorites()}),$("a[href=\"#servers\"]").click(()=>{this.renderList()})}saveStorage(){chrome.storage.local.set(this.storage)}initListeners(){chrome.storage.onChanged.addListener(a=>{if(this.storage)for(let b in a)"favorites"==b&&(this.storage[b]=a[b].newValue)})}initHandlers(){$("body").on("click",".open-countries-dropdown-btn",function(){$("#countries-dropdown").slideToggle(150,function(){$(this).css("display","flex")}),navigator.userAgent.toLowerCase().includes("firefox")&&(500<$("body").height()?$("body").height(355):$("body").height(555)),$(document).ready(function(){$(".tabs").tabs()})}),this.$box.on("click",".x-select-view",()=>{this.resetSearch(),this.renderList()}),this.$box.on("click",".x-select-item",a=>{const b=$(a.target).closest(".x-select-item");b.closest(".x-select-dropdown").slideUp(150),navigator.userAgent.toLowerCase().includes("firefox")&&$("body").height(355),this.value==b.attr("value"),this.value=b.attr("value"),"auto"!=this.value&&(this.renderView(),this.setSelected(this.value)),this.cb(this.value)}),this.$box.on("click",".favorite-btn",a=>{a.stopPropagation();let b=a.target;for(let c=0;5>c;c++){if(b.dataset.title&&b.classList.contains("favorite-btn")){let a=this.storage.favorites.findIndex(a=>a.country_code===b.dataset.value);return-1==a?(this.storage.favorites.push(this.storage.locations.find(a=>a.country_code===b.dataset.value)),b.parentNode.parentNode.classList.add("favorite")):(this.storage.favorites.splice(a,1),b.parentNode.parentNode.classList.remove("favorite")),this.saveStorage(),void this.renderFavorites()}b=b.parentNode}this.saveStorage()}),this.$box.on("click",".back-btn",()=>{this.$box.find(".x-select-dropdown").slideUp(150)}),this.$box.find("#search_country").on("input",a=>{this.searchQuery=a.target.value,this.renderList()})}resetSearch(){this.$box.find("#search_country").val(""),this.searchQuery=""}filterItems(){let a=[],b=new RegExp(this.searchQuery,"gi");for(let c=0;c<this.items.length;c++)this.items[c].title.match(b)&&a.push(this.items[c]);return a}setSelected(a){let b=this.findItem(a);b&&($("#next_connect").children().eq(0).attr("src",`/img/flags/${b.value}.svg`),$("#next_connect").children().eq(1).html(b.title),$("#flag_icon").attr("src",`/img/flags/${b.value}.svg`))}findItem(a){for(let b=0;b<this.items.length;b++)if(this.items[b].value==a)return this.items[b];return null}renderView(){this.$box.find(".x-select-view").html(`            <img class="x-select-icon" src="/img/flags/${this.selectedItem.value}.svg">            <div class="x-select-title">${this.selectedItem.title}</div>            <div class="x-select-arrow"></div>        `)}renderFavorites(){this.$box.find(".x-select-dropdown #favorite .countries").html(this.storage.favorites.map(a=>`                <div class="x-select-item waves-effect waves-teal ${-1==this.storage.favorites.findIndex(b=>b.country_code===a.country_code)?"":"favorite"}" value="${a.country_code}">                    <div class="name-wrap">                        <img class="x-select-icon" src="/img/flags/${a.country_code}.svg">                        <div class="x-select-title">${a.country_name}</div>                    </div>                    <div class="nav-wrap">                        <div data-title="${a.country_name}" data-value="${a.country_code}" class="favorite-btn waves-effect waves-teal">                            <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="126.729px" height="126.73px" viewBox="0 0 126.729 126.73" xml:space="preserve"><g><path data-v-61cfb8f2="" fill="#ffd11a" d="M121.215,44.212l-34.899-3.3c-2.2-0.2-4.101-1.6-5-3.7l-12.5-30.3c-2-5-9.101-5-11.101,0l-12.4,30.3                            c-0.8,2.1-2.8,3.5-5,3.7l-34.9,3.3c-5.2,0.5-7.3,7-3.4,10.5l26.3,23.1c1.7,1.5,2.4,3.7,1.9,5.9l-7.9,32.399                            c-1.2,5.101,4.3,9.3,8.9,6.601l29.1-17.101c1.9-1.1,4.2-1.1,6.1,0l29.101,17.101c4.6,2.699,10.1-1.4,8.899-6.601l-7.8-32.399                            c-0.5-2.2,0.2-4.4,1.9-5.9l26.3-23.1C128.615,51.212,126.415,44.712,121.215,44.212z"></path></g></svg>                        </div>                        <div class="signal">                            <svg class="quality-${a.quality}" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"                                width="511.626px" height="511.627px" viewBox="0 0 511.626 511.627" style="enable-background:new 0 0 511.626 511.627;"                                xml:space="preserve">                                <g>                                    <g>                                        <path d="M63.953,401.992H9.135c-2.666,0-4.853,0.855-6.567,2.567C0.859,406.271,0,408.461,0,411.126v54.82                                            c0,2.665,0.855,4.855,2.568,6.563c1.714,1.718,3.905,2.57,6.567,2.57h54.818c2.663,0,4.853-0.853,6.567-2.57                                            c1.712-1.708,2.568-3.898,2.568-6.563v-54.82c0-2.665-0.856-4.849-2.568-6.566C68.806,402.848,66.616,401.992,63.953,401.992z"/>                                        <path d="M283.225,292.36h-54.818c-2.667,0-4.854,0.855-6.567,2.566c-1.711,1.711-2.57,3.901-2.57,6.563v164.456                                            c0,2.665,0.856,4.855,2.57,6.563c1.713,1.718,3.899,2.57,6.567,2.57h54.818c2.665,0,4.855-0.853,6.563-2.57                                            c1.711-1.708,2.573-3.898,2.573-6.563V301.49c0-2.662-0.862-4.853-2.573-6.563C288.081,293.216,285.89,292.36,283.225,292.36z"/>                                        <path d="M173.589,365.451h-54.818c-2.667,0-4.854,0.855-6.567,2.566c-1.711,1.711-2.568,3.901-2.568,6.563v91.358                                            c0,2.669,0.854,4.859,2.568,6.57c1.713,1.711,3.899,2.566,6.567,2.566h54.818c2.663,0,4.853-0.855,6.567-2.566                                            c1.709-1.711,2.568-3.901,2.568-6.57v-91.358c0-2.662-0.859-4.853-2.568-6.563C178.442,366.307,176.251,365.451,173.589,365.451z"                                            />                                        <path d="M392.857,182.725h-54.819c-2.666,0-4.856,0.855-6.57,2.568c-1.708,1.714-2.563,3.901-2.563,6.567v274.086                                            c0,2.665,0.855,4.855,2.563,6.563c1.714,1.718,3.904,2.57,6.57,2.57h54.819c2.666,0,4.856-0.853,6.563-2.57                                            c1.718-1.708,2.57-3.898,2.57-6.563V191.86c0-2.666-0.853-4.853-2.57-6.567C397.713,183.58,395.523,182.725,392.857,182.725z"/>                                        <path d="M509.06,39.115c-1.718-1.714-3.901-2.568-6.57-2.568h-54.816c-2.662,0-4.853,0.854-6.567,2.568                                            c-1.714,1.709-2.569,3.899-2.569,6.563v420.268c0,2.665,0.855,4.855,2.569,6.563c1.715,1.718,3.905,2.57,6.567,2.57h54.816                                            c2.669,0,4.853-0.853,6.57-2.57c1.711-1.708,2.566-3.898,2.566-6.563V45.679C511.626,43.015,510.771,40.825,509.06,39.115z"/>                                    </g>                                </g>                            </svg>                        </div>                    </div>                </div>            `).join(""))}renderList(){let a=this.filterItems();this.$box.find(".x-select-dropdown #servers .countries").html(`<div class="x-select-item waves-effect waves-teal" value="auto">                <div class="name-wrap auto">                    <img class="x-select-icon" src="/img/auto.png">                    <span class="x-select-title">Auto</span>                </div>                <div class="nav-wrap">                    <div class="signal">                        <svg class="quality-5" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"                            width="511.626px" height="511.627px" viewBox="0 0 511.626 511.627" style="enable-background:new 0 0 511.626 511.627;"                            xml:space="preserve">                            <g>                                <g>                                    <path d="M63.953,401.992H9.135c-2.666,0-4.853,0.855-6.567,2.567C0.859,406.271,0,408.461,0,411.126v54.82                                        c0,2.665,0.855,4.855,2.568,6.563c1.714,1.718,3.905,2.57,6.567,2.57h54.818c2.663,0,4.853-0.853,6.567-2.57                                        c1.712-1.708,2.568-3.898,2.568-6.563v-54.82c0-2.665-0.856-4.849-2.568-6.566C68.806,402.848,66.616,401.992,63.953,401.992z"/>                                    <path d="M283.225,292.36h-54.818c-2.667,0-4.854,0.855-6.567,2.566c-1.711,1.711-2.57,3.901-2.57,6.563v164.456                                        c0,2.665,0.856,4.855,2.57,6.563c1.713,1.718,3.899,2.57,6.567,2.57h54.818c2.665,0,4.855-0.853,6.563-2.57                                        c1.711-1.708,2.573-3.898,2.573-6.563V301.49c0-2.662-0.862-4.853-2.573-6.563C288.081,293.216,285.89,292.36,283.225,292.36z"/>                                    <path d="M173.589,365.451h-54.818c-2.667,0-4.854,0.855-6.567,2.566c-1.711,1.711-2.568,3.901-2.568,6.563v91.358                                        c0,2.669,0.854,4.859,2.568,6.57c1.713,1.711,3.899,2.566,6.567,2.566h54.818c2.663,0,4.853-0.855,6.567-2.566                                        c1.709-1.711,2.568-3.901,2.568-6.57v-91.358c0-2.662-0.859-4.853-2.568-6.563C178.442,366.307,176.251,365.451,173.589,365.451z"                                        />                                    <path d="M392.857,182.725h-54.819c-2.666,0-4.856,0.855-6.57,2.568c-1.708,1.714-2.563,3.901-2.563,6.567v274.086                                        c0,2.665,0.855,4.855,2.563,6.563c1.714,1.718,3.904,2.57,6.57,2.57h54.819c2.666,0,4.856-0.853,6.563-2.57                                        c1.718-1.708,2.57-3.898,2.57-6.563V191.86c0-2.666-0.853-4.853-2.57-6.567C397.713,183.58,395.523,182.725,392.857,182.725z"/>                                    <path d="M509.06,39.115c-1.718-1.714-3.901-2.568-6.57-2.568h-54.816c-2.662,0-4.853,0.854-6.567,2.568                                        c-1.714,1.709-2.569,3.899-2.569,6.563v420.268c0,2.665,0.855,4.855,2.569,6.563c1.715,1.718,3.905,2.57,6.567,2.57h54.816                                        c2.669,0,4.853-0.853,6.57-2.57c1.711-1.708,2.566-3.898,2.566-6.563V45.679C511.626,43.015,510.771,40.825,509.06,39.115z"/>                                </g>                            </g>                        </svg>                    </div>                </div>            </div>`+a.map(a=>`                <div class="x-select-item waves-effect waves-teal ${-1==this.storage.favorites.findIndex(b=>b.country_code===a.value)?"":"favorite"}" value="${a.value}">                    <div class="name-wrap">                        <img class="x-select-icon" src="/img/flags/${a.value}.svg">                        <span class="x-select-title">${a.title}</span>                    </div>                    <div class="nav-wrap">                        <div data-title="${a.title}" data-value="${a.value}" class="favorite-btn waves-effect waves-teal">                            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="126.729px" height="126.73px" viewBox="0 0 126.729 126.73" xml:space="preserve"><g><path data-v-61cfb8f2="" fill="#ffd11a" d="M121.215,44.212l-34.899-3.3c-2.2-0.2-4.101-1.6-5-3.7l-12.5-30.3c-2-5-9.101-5-11.101,0l-12.4,30.3                            c-0.8,2.1-2.8,3.5-5,3.7l-34.9,3.3c-5.2,0.5-7.3,7-3.4,10.5l26.3,23.1c1.7,1.5,2.4,3.7,1.9,5.9l-7.9,32.399                            c-1.2,5.101,4.3,9.3,8.9,6.601l29.1-17.101c1.9-1.1,4.2-1.1,6.1,0l29.101,17.101c4.6,2.699,10.1-1.4,8.899-6.601l-7.8-32.399                            c-0.5-2.2,0.2-4.4,1.9-5.9l26.3-23.1C128.615,51.212,126.415,44.712,121.215,44.212z"></path></g></svg>                        </div>                        <div class="signal">                            <svg class="quality-${a.quality}" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"                                width="511.626px" height="511.627px" viewBox="0 0 511.626 511.627" style="enable-background:new 0 0 511.626 511.627;"                                xml:space="preserve">                                <g>                                    <g>                                        <path d="M63.953,401.992H9.135c-2.666,0-4.853,0.855-6.567,2.567C0.859,406.271,0,408.461,0,411.126v54.82                                            c0,2.665,0.855,4.855,2.568,6.563c1.714,1.718,3.905,2.57,6.567,2.57h54.818c2.663,0,4.853-0.853,6.567-2.57                                            c1.712-1.708,2.568-3.898,2.568-6.563v-54.82c0-2.665-0.856-4.849-2.568-6.566C68.806,402.848,66.616,401.992,63.953,401.992z"/>                                        <path d="M283.225,292.36h-54.818c-2.667,0-4.854,0.855-6.567,2.566c-1.711,1.711-2.57,3.901-2.57,6.563v164.456                                            c0,2.665,0.856,4.855,2.57,6.563c1.713,1.718,3.899,2.57,6.567,2.57h54.818c2.665,0,4.855-0.853,6.563-2.57                                            c1.711-1.708,2.573-3.898,2.573-6.563V301.49c0-2.662-0.862-4.853-2.573-6.563C288.081,293.216,285.89,292.36,283.225,292.36z"/>                                        <path d="M173.589,365.451h-54.818c-2.667,0-4.854,0.855-6.567,2.566c-1.711,1.711-2.568,3.901-2.568,6.563v91.358                                            c0,2.669,0.854,4.859,2.568,6.57c1.713,1.711,3.899,2.566,6.567,2.566h54.818c2.663,0,4.853-0.855,6.567-2.566                                            c1.709-1.711,2.568-3.901,2.568-6.57v-91.358c0-2.662-0.859-4.853-2.568-6.563C178.442,366.307,176.251,365.451,173.589,365.451z"                                            />                                        <path d="M392.857,182.725h-54.819c-2.666,0-4.856,0.855-6.57,2.568c-1.708,1.714-2.563,3.901-2.563,6.567v274.086                                            c0,2.665,0.855,4.855,2.563,6.563c1.714,1.718,3.904,2.57,6.57,2.57h54.819c2.666,0,4.856-0.853,6.563-2.57                                            c1.718-1.708,2.57-3.898,2.57-6.563V191.86c0-2.666-0.853-4.853-2.57-6.567C397.713,183.58,395.523,182.725,392.857,182.725z"/>                                        <path d="M509.06,39.115c-1.718-1.714-3.901-2.568-6.57-2.568h-54.816c-2.662,0-4.853,0.854-6.567,2.568                                            c-1.714,1.709-2.569,3.899-2.569,6.563v420.268c0,2.665,0.855,4.855,2.569,6.563c1.715,1.718,3.905,2.57,6.567,2.57h54.816                                            c2.669,0,4.853-0.853,6.57-2.57c1.711-1.708,2.566-3.898,2.566-6.563V45.679C511.626,43.015,510.771,40.825,509.06,39.115z"/>                                    </g>                                </g>                            </svg>                        </div>                    </div>                </div>            `).join(""))}};